<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hunga Tonga Cinematic Zoom</title>

  <link rel="stylesheet" href="style.css" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- PapaParse -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body

  <!-- Scene 1 + Scene 1.5 -->
  <section class="intro-scene">
    <video class="static-earth" autoplay muted loop playsinline>
      <source src="assets/static-earth.mp4" type="video/mp4" />
    </video>

    <p class="intro-text watcher-text">
      Let's revisit an event that happened far off from us...<br>
      yet affecting us.
    </p>

    <!-- Appears after video fades out -->
    <p class="intro-text location-text" id="locationText">
      Let’s go to the location.<br>
      <span class="scroll-down">↓ Scroll Down ↓</span>
    </p>

    <div class="left-mask"></div>
  </section>

  <!-- Scene 2 (Zoom sequence) -->
  <section class="scene-two">
    <div class="image-sequence-container" id="imageSequenceContainer">
<img id="sequenceImage" src="" alt="Zoom Sequence Frame">                   
      <p class="hunga-text">Hunga Tonga</p>
    </div>
    <div class="scroll-space"></div>
  </section>

  <!-- Scene 3: Event Introduction and Video -->

<!-- Spacer to delay the appearance until frame 455 scrolls out -->
<div style="height: 120vh;"></div>

<section class="event-section">
  <div class="event-text">
    <p>Let's see, what happened here on </p>
      <p>January 22, 2022.</p>
  </div>

  <!-- Scroll Trigger Marker -->
  <div class="trigger-marker" id="videoTriggerMarker"></div>

  <div class="video-wrapper" id="eventVideoWrapper">
    <video id="eventVideo" muted playsinline>
      <source src="assets/hunga-eruption.mp4" type="video/mp4" />
    </video>
  </div>
</section>

<!-- Scene 4: Key Facts Section -->
<section class="facts-section">
  <div class="fact-line left">
    <span class="fact-number">150m</span> below sea level – the volcano’s summit
  </div>
  <div class="fact-line right">
    <span class="fact-number">Mesosphere</span> reached by water vapor for the first time
  </div>
  <div class="fact-line left">
    <span class="fact-number">10%</span> more water vapor than usual reached the stratosphere
  </div>
  <div class="fact-line right">
    <span class="fact-number">+0.035°C</span> estimated global temp rise due to vapor trap
  </div>
  <div class="fact-line left">
    <span class="fact-number">7×</span> pressure waves circled the Earth
  </div>
</section>

<!-- Spacer between facts and intro -->
<div class="spacer"></div>

<!-- INTRO TEXT SECTION -->
<h2 class="intro-heading">
  From here on, we will see what were the aftermath of this eruption.
</h2>

<!-- Spacer between intro and chart -->
<div class="spacer"></div>

<!-- TEMPERATURE CHART SECTION -->
<section id="chart-section" class="chart-section">
  <h3 class="chart-title">Monthly Global Temperature Rise</h3>
  <div class="chart-container">
    <canvas id="tempChart" width="800" height="400"></canvas>
  </div>
</section>

<script>
  let chart;

  const labels = ['Dec 21','Jan 22', 'Feb 22', 'Mar 22', 'Apr 22', 'May 22', 'Jun 22', 'Jul 22', 'Aug 22', 'Sep 22', 'Oct 22', 'Nov 22', 'Dec 22', 'Jan 23'];
  const tempData = [0.83, 0.89, 0.85, 0.82, 0.8, 0.78, 0.76, 0.78, 0.8, 0.82, 0.85, 0.87, 0.89, 0.87];
  const baselineData = [0.83, 0.834, 0.832, 0.836, 0.838, 0.84, 0.842, 0.844, 0.846, 0.848, 0.85, 0.852, 0.854, 0.856];

  const animatedData = Array(tempData.length).fill(null);

  const ctx = document.getElementById('tempChart').getContext('2d');

  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [
        {
          label: 'Temperature Rise (°C)',
          data: animatedData,
          borderColor: 'red',
          borderWidth: 2,
          tension: 0.4,
          pointBackgroundColor: 'white',
          pointRadius: 4,
          pointHoverRadius: 6
        },
        {
          label: 'Baseline Temperature (°C)',
          data: baselineData,
          borderColor: 'white',
          borderWidth: 2,
          borderDash: [4, 4],
          tension: 0,
          pointRadius: 0
        }
      ]
    },
    options: {
      responsive: true,
      animation: false,
      plugins: {
        legend: {
          labels: {
            color: 'white'
          }
        }
      },
      scales: {
        x: {
          ticks: {
            color: 'white'
          },
          grid: {
            color: 'rgba(255,255,255,0.1)'
          }
        },
        y: {
          ticks: {
            color: 'white'
          },
          grid: {
            color: 'rgba(255,255,255,0.1)'
          }
        }
      }
    }
  });

  let currentIndex = 0;
  function animateChart() {
    if (currentIndex < tempData.length) {
      animatedData[currentIndex] = tempData[currentIndex];
      chart.update('none');
      currentIndex++;
      requestAnimationFrame(animateChart);
    }
  }

  animateChart();
</script>



<!-- ISOTYPE CHART SECTION -->
<section id="isotype-chart" class="isotype-section">
  <div class="isotype-container">
    <!-- LEFT SIDE (Volcano + Text) -->
    <div class="isotype-left">
      <img src="assets/steamb.jpeg" alt="Steam Volcano">
     
    </div>

    <!-- RIGHT SIDE (Planes) -->
    <div id="plane-container" class="isotype-right">
      <!-- Planes will be injected here -->
    </div>
  </div>
</section>

<!-- TEXT BELOW PLANES -->
<div id="isotype-caption" style="display: none; opacity: 0;">
  <div class="caption-row">
  <span class="caption-left">
    Water Vapor Released: <span class="highlight">146 Tg</span> (teragrams)
  </span>
  <span class="caption-right">
    Equivalent to <span class="highlight">30 years</span> of global aviation
  </span>
</div>

</div>

<script>
  const isotypeSection = document.getElementById("isotype-chart");
  const planeContainer = document.getElementById("plane-container");
  const caption = document.getElementById("isotype-caption");

  let isotypeRevealed = false;

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting && !isotypeRevealed) {
        isotypeRevealed = true;

        isotypeSection.style.display = 'flex';
        setTimeout(() => isotypeSection.style.opacity = 1, 100);

        // Animate 30 planes
        for (let i = 0; i < 30; i++) {
          setTimeout(() => {
            const plane = document.createElement("img");
            plane.src = "assets/plane_isotype.png";
            plane.classList.add("plane-icon");
            planeContainer.appendChild(plane);
            requestAnimationFrame(() => {
              plane.style.opacity = 1;
            });
          }, i * 100);
        }

        // Show caption after animation
        setTimeout(() => {
          caption.style.display = 'block';
          setTimeout(() => caption.style.opacity = 1, 100);
        }, 30 * 100 + 500);
      }
    });
  }, 
  {
    threshold: 0.5
  });

  // Observe element after animated chart ends
  observer.observe(document.querySelector("#chart-section")); // Replace with correct final animated chart container ID
</script>

  <script src="script.js"></script>
</body>
</html>
